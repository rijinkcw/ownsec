#!/bin/bash

. /opt/ownsec/ITSEC-Install-Scripts-ORIG/001.functions/all-scripts.sh

GITREPO=https://github.com/OWASP/OWASP-WebScarab.git
BRANCH=master
GITREPOROOT=/opt/ITSEC/2.Vulnerability-Scanner/owasp-webscarab/OWASP/OWASP-WebScarab
GITCONFDIR=/opt/ITSEC/2.Vulnerability-Scanner/owasp-webscarab/OWASP/OWASP-WebScarab/.git
GITCLONEDIR=/opt/ITSEC/2.Vulnerability-Scanner/owasp-webscarab/OWASP
EXECUTEABLE1=webscarab.jar
EXECUTEABLE2=webscarab.sh
EXECUTEABLE3=webscarab
DSKTPFLS=/opt/ownsec/ITSEC-Install-Scripts-ORIG/2.Vulnerability-Scanner/owasp-webscarab
DSKTPFLSDEST=/home/$USER/.local/share/applications/2.Vulnerability-Scanner/owasp-webscarab
DSKTPFL=webscarab.desktop
APTLSTDIR=/opt/ownsec/ITSEC-Install-Scripts-ORIG/2.Vulnerability-Scanner/owasp-webscarab

BANNER () {
	echo "${bold}
	__        _______ ____ ____   ____    _    ____      _    ____  
	\ \      / / ____| __ ) ___| / ___|  / \  |  _ \    / \  | __ ) 
	 \ \ /\ / /|  _| |  _ \___ \| |     / _ \ | |_) |  / _ \ |  _ \ 
	  \ V  V / | |___| |_) |__) | |___ / ___ \|  _ <  / ___ \| |_) |
	   \_/\_/  |_____|____/____/ \____/_/   \_\_| \_\/_/   \_\____/ 
		   
	INSTALL  
	${normal}"
}
DEPS () {
	sudo apt-get update
	sudo apt-get upgrade
	xargs -a <(awk '/^\s*[^#]/' "$APTLSTDIR/deps-webscarab.txt") -r -- sudo apt-get install -y
	sudo updatedb
	sudo ldconfig
}
JAREXEC () {
	echo '#!/bin/bash
	 
	cd /opt/ITSEC/2.Vulnerability-Scanner/owasp-webscarab/OWASP/OWASP-WebScarab

	java -jar webscarab.jar "$@"' > $EXECUTEABLE2

	chmod +x $EXECUTEABLE1
	chmod +x $EXECUTEABLE2
}

BANNER
GITCLONEFUNC
DEPS
GITSBMDLINIT
ant -d
JAREXEC
sudo rm -f $BINDIR/$EXECUTEABLE3
sudo ln -s $GITREPOROOT/$EXECUTEABLE2 $BINDIR/$EXECUTEABLE3
CPDESKTFL


